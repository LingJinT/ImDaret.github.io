

<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>React Hook - pingchangxin&#39;Blog</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />

  
  
  <meta name="description" content="ç®€å•çš„ç¤ºä¾‹123456789101112import ..."> 
  
  <meta name="author" content="pingchangxin"> 

  
    <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  
  
    <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  
  
    <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  
  
    <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
  
<link rel="stylesheet" href="//at.alicdn.com/t/font_1445822_hhodbqn7tit.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css">

  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      fancybox: true,
      pjax: false,
      lazyload: {
        enable: true,
        loadingImage: '/images/theme/loading.gif',
      },
      donate: {
        enable: true,
        alipay: '/images/theme/zhifubao.jpg',
        wechat: '/images/theme/weixin.jpg'
      },
      motto: {
        api: '',
        default: 'ç¥ä½ ä¸‡äº‹èƒœæ„'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        alwaysShow: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: true
      }
    }
  </script>

  

  
<meta name="generator" content="Hexo 5.0.0"></head>
<body class="lock-screen">
  <div class="loading"></div>
  


<nav class="navbar">
  <div class="left"></div>
  <div class="center">React Hook</div>
  <div class="right">
    <i class="iconfont iconmenu j-navbar-menu"></i>
  </div>
</nav>

  <nav class="menu">
  <div class="menu-wrap">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content">
      
      
      
      
      <li class="menu-item"><a href="/ " class="underline"> é¦–é¡µ</a></li>
      
      
      
      
      <li class="menu-item"><a href="/galleries " class="underline"> æ‘„å½±</a></li>
      
      
      
      
      <li class="menu-item"><a href="/archives " class="underline"> å½’æ¡£</a></li>
      
      
      
      
      <li class="menu-item"><a href="/tags " class="underline"> æ ‡ç­¾</a></li>
      
      
      
      
      <li class="menu-item"><a href="/categories " class="underline"> åˆ†ç±»</a></li>
      
      
      
      
      <li class="menu-item"><a href="/about " class="underline"> å…³äº</a></li>
      
    </ul>
    <div class="menu-copyright"><p>CopyrightÂ© 2019-2020 | <a target="_blank" href="https://www.001f3.cn">å¹³å¸¸å¿ƒ</a> .AllRightsReserved</p></div>
  </div>
</nav>
  <main id="main">
  <div class="container" id="container">
    <article class="article">
  <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">React Hook</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>Mar 17, 2021</span
        class="post-info-item">
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>9859</span>
    </div>
  </div>
</section>
  <section class="main">
    <section class="content">
      <h1 id="ç®€å•çš„ç¤ºä¾‹"><a href="#ç®€å•çš„ç¤ºä¾‹" class="headerlink" title="ç®€å•çš„ç¤ºä¾‹"></a>ç®€å•çš„ç¤ºä¾‹</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-keyword">return</span> (<br>    &lt;div&gt;<br>      &lt;p&gt;you clicked me &#123;count&#125; times&lt;/p&gt;<br>      &lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> setCount(count++)&#125;&gt;click me&lt;/button&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>useState</code>è¿”å›ä¸€å¯¹å€¼ï¼Œç¬¬ä¸€ä¸ªå€¼ä»£è¡¨å½“å‰çŠ¶æ€ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªæ›´æ–°å½“å‰çŠ¶æ€çš„å‡½æ•°ã€‚</p>
<p><code>useState</code>å”¯ä¸€çš„å‚æ•°å°±æ˜¯å½“å‰çŠ¶æ€çš„åˆå§‹å€¼ã€‚</p>
<h1 id="Hook-æ¦‚è¿°"><a href="#Hook-æ¦‚è¿°" class="headerlink" title="Hook æ¦‚è¿°"></a>Hook æ¦‚è¿°</h1><h2 id="ä»€ä¹ˆæ˜¯-Hook"><a href="#ä»€ä¹ˆæ˜¯-Hook" class="headerlink" title="ä»€ä¹ˆæ˜¯ Hook"></a>ä»€ä¹ˆæ˜¯ Hook</h2><p>Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€é’©å…¥â€React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚</p>
<h2 id="state-Hook"><a href="#state-Hook" class="headerlink" title="state Hook"></a>state Hook</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-keyword">return</span> (<br>    &lt;div&gt;<br>      &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt;<br>      &lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> setCount(count + <span class="hljs-number">1</span>)&#125;&gt;Click me&lt;/button&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>ç¬¬ä¸€è¡Œå¼•å…¥<code>useState</code>Hook</li>
<li>ç¬¬å››è¡Œå®šä¹‰äº† count çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„å‡½æ•° setCountï¼Œå¹¶èµ‹äºˆåˆå§‹å€¼ 0ã€‚</li>
<li>ç¬¬ä¹è¡Œç”¨æˆ·ç‚¹å‡»åæ›´æ–° count,å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</li>
</ol>
<h2 id="Effect-Hook"><a href="#Effect-Hook" class="headerlink" title="Effect Hook"></a>Effect Hook</h2><p>å‰¯ä½œç”¨é’©å­å‡½æ•°ã€‚ä¸ class ç»„ä»¶ä¸­çš„<code>componentDidmount</code>ã€<code>componentDidUpdate</code>ã€<code>componentWillUnmount</code>å…·æœ‰ç›¸åŒçš„ç”¨é€”ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Example</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);<br><br>  <span class="hljs-comment">// ç›¸å½“äº componentDidmount å’Œ componentUpdate</span><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`you clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span>;<br>  &#125;);<br><br>  <span class="hljs-keyword">return</span> (<br>    &lt;div&gt;<br>      &lt;p&gt;you clicked me &#123;count&#125; times&lt;/p&gt;<br>      &lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> setCount(count++)&#125;&gt;click me&lt;/button&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨ JavaScript é—­åŒ…æœºåˆ¶ï¼Œç›´æ¥è®¿é—® State å˜é‡ã€‚</p>
<p>åœ¨ä½ å®Œæˆå¯¹ DOM çš„æ›´æ”¹åä¼šè¿è¡Œ<code>useEffect</code>å‰¯ä½œç”¨å‡½æ•°ï¼Œè€Œä¸”ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè°ƒç”¨ï¼ˆå¯ä»¥æ§åˆ¶ï¼‰ã€‚</p>
<p><code>useEffect</code>å‡½æ•°è¿˜å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªå‡½æ•°æ¥æ¸…é™¤å‰¯ä½œç”¨ã€‚ä¾‹å¦‚ä¸Šé¢çš„ useEffect å¯ä»¥å†™æˆï¼š</p>
<h2 id="æ¸…é™¤è®¢é˜…"><a href="#æ¸…é™¤è®¢é˜…" class="headerlink" title="æ¸…é™¤è®¢é˜…"></a>æ¸…é™¤è®¢é˜…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);<br>  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);<br>  &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>ä¸Šè¿°ç¤ºä¾‹ä¼šåœ¨ React ç»„ä»¶é”€æ¯æ—¶å–æ¶ˆ ChatAPI çš„è®¢é˜…ã€‚</p>
<h2 id="å¯ä»¥ä½¿ç”¨å¤šä¸ª-useEffect"><a href="#å¯ä»¥ä½¿ç”¨å¤šä¸ª-useEffect" class="headerlink" title="å¯ä»¥ä½¿ç”¨å¤šä¸ª useEffect"></a>å¯ä»¥ä½¿ç”¨å¤šä¸ª useEffect</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`you clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span>;<br>&#125;);<br><br>useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);<br>  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);<br>  &#125;;<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>å¦‚ä¸Šå¯ä»¥å°†ä¸¤ä¸ªä¸åŒä½œç”¨çš„å‰¯ä½œç”¨å‡½æ•°æ‹†å¼€ï¼Œé€šå¸¸ç”¨äºé€»è¾‘åˆ†ç¦»ã€‚</p>
<h2 id="Effect-æ€§èƒ½ä¼˜åŒ–"><a href="#Effect-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="Effect æ€§èƒ½ä¼˜åŒ–"></a>Effect æ€§èƒ½ä¼˜åŒ–</h2><p>ç”±äºæ¯æ¬¡é‡æ–°æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œ Effectï¼Œæ‰€ä»¥æœ‰å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’æ•°ç»„ä½œä¸º<code>useEffect</code>çš„ç¬¬äºŒä¸ªå‚æ•°æ¥è·³è¿‡è¿™æ¬¡è°ƒç”¨,ä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span>;<br>&#125;, [count]); <span class="hljs-comment">// ä»…åœ¨ count æ›´æ”¹æ—¶æ›´æ–°;</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä¾‹å­å°†ä¼šæ¯”è¾ƒ count å€¼ï¼Œä¾‹å¦‚ count çš„å€¼æ˜¯ 5ï¼Œé‡æ–°æ¸²æŸ“åçš„å€¼è¿˜æ˜¯ 5ï¼Œé‚£ä¹ˆå°±ä¼šè·³è¿‡è¿™ä¸ª effectã€‚å¦‚æœæ•°ç»„ä¸­æœ‰å¤šä¸ªå…ƒç´ ï¼Œåªè¦æœ‰ä¸€ä¸ªå…ƒç´ å’ŒåŸæ¥å€¼ä¸åŒå°±ä¼šæ‰§è¡Œ effectã€‚</p>
<p>åƒè¿™ç§æ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼å¯¹æ¸…æ¥šæ“ä½œçš„ effect åŒæ ·é€‚ç”¨ï¼šä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleStatusChange</span>(<span class="hljs-params">status</span>) </span>&#123;<br>    setIsOnline(status.isOnline);<br>  &#125;<br><br>  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);<br>  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);<br>  &#125;;<br>&#125;, [props.friend.id]); <span class="hljs-comment">// ä»…åœ¨ props.friend.id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è®¢é˜…</span><br></code></pre></td></tr></table></figure>

<h2 id="Hook-ä½¿ç”¨è§„åˆ™"><a href="#Hook-ä½¿ç”¨è§„åˆ™" class="headerlink" title="Hook ä½¿ç”¨è§„åˆ™"></a>Hook ä½¿ç”¨è§„åˆ™</h2><ol>
<li>åªèƒ½åœ¨å‡½æ•°æœ€å¤–å±‚è°ƒç”¨ Hookã€‚</li>
<li>åªèƒ½åœ¨ React çš„å‡½æ•°ç»„ä»¶æˆ–è€…è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨ Hookã€‚</li>
</ol>
<h2 id="è‡ªå®šä¹‰-Hook"><a href="#è‡ªå®šä¹‰-Hook" class="headerlink" title="è‡ªå®šä¹‰ Hook"></a>è‡ªå®šä¹‰ Hook</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> React, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFriendStatus</span>(<span class="hljs-params">friendID</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [isOnline, setIsOnline] = useState(<span class="hljs-literal">null</span>);<br><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleStatusChange</span>(<span class="hljs-params">status</span>) </span>&#123;<br>    setIsOnline(status.isOnline);<br>  &#125;<br><br>  useEffect(<span class="hljs-function">() =&gt;</span> &#123;<br>    ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange);<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>      ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange);<br>    &#125;;<br>  &#125;);<br><br>  <span class="hljs-keyword">return</span> isOnline;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä¸Šé¢<code>useFriendStatus</code>æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ Hookï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä½¿ç”¨å®ƒï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FriendStatus</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> isOnline = useFriendStatus(props.friend.id);<br><br>  <span class="hljs-keyword">if</span> (isOnline === <span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Loading...&quot;</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> isOnline ? <span class="hljs-string">&quot;Online&quot;</span> : <span class="hljs-string">&quot;Offline&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FriendListItem</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> isOnline = useFriendStatus(props.friend.id);<br><br>  <span class="hljs-keyword">return</span> (<br>    &lt;li style=&#123;&#123; <span class="hljs-attr">color</span>: isOnline ? <span class="hljs-string">&quot;green&quot;</span> : <span class="hljs-string">&quot;black&quot;</span> &#125;&#125;&gt;&#123;props.friend.name&#125;&lt;/li&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨å•ä¸ªç»„ä»¶ä¸­å¯ä»¥è°ƒç”¨å¤šæ¬¡è‡ªå®šä¹‰ Hook</p>
<p>è‡ªå®šä¹‰ Hook æ›´åƒæ˜¯ä¸€ç§çº¦å®šï¼Œå¦‚æœå‡½æ•°ä»¥<code>use</code>å¼€å¤´å¹¶è°ƒç”¨å…¶ä»– Hook åˆ™ç§°ä¸ºè‡ªå®šä¹‰ Hookã€‚</p>
<p>ä¸åŒç»„ä»¶ä¹‹é—´è°ƒç”¨è‡ªå®šä¹‰ Hook ä¸ä¼šå…±äº« state</p>
<p>è‡ªå®šä¹‰ Hook å¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´ï¼Œæ¯”å¦‚æœ€å¸¸ç”¨çš„ redux ä¹Ÿå¯ä»¥å†™æˆè‡ªå®šä¹‰ Hookï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useReducer</span>(<span class="hljs-params">reducer, initialState</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [state, setState] = useState(initialState);<br><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">action</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> nextState = reducer(state, action);<br>    setState(nextState);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> [state, dispatch];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Todos</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [todos, dispatch] = useReducer(todosReducer, []);<br><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleAddClick</span>(<span class="hljs-params">text</span>) </span>&#123;<br>    dispatch(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;add&quot;</span>, text &#125;);<br>  &#125;<br><br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å®˜æ–¹å·²ç»å°†<code>useReducer</code>çš„ Hook å†…ç½®åœ¨äº† React ä¸­ã€‚</p>
<h1 id="Hook-è§„åˆ™æ‹“å±•"><a href="#Hook-è§„åˆ™æ‹“å±•" class="headerlink" title="Hook è§„åˆ™æ‹“å±•"></a>Hook è§„åˆ™æ‹“å±•</h1><h2 id="ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨å¤šä¸ª-useState-å’Œ-useEffect"><a href="#ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨å¤šä¸ª-useState-å’Œ-useEffect" class="headerlink" title="ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨å¤šä¸ª useState å’Œ useEffect?"></a>ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨å¤šä¸ª useState å’Œ useEffect?</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Form</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-comment">// 1. Use the name state variable</span><br>  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">&quot;Mary&quot;</span>);<br><br>  <span class="hljs-comment">// 2. Use an effect for persisting the form</span><br>  useEffect(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">persistForm</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">localStorage</span>.setItem(<span class="hljs-string">&quot;formData&quot;</span>, name);<br>  &#125;);<br><br>  <span class="hljs-comment">// 3. Use the surname state variable</span><br>  <span class="hljs-keyword">const</span> [surname, setSurname] = useState(<span class="hljs-string">&quot;Poppins&quot;</span>);<br><br>  <span class="hljs-comment">// 4. Use an effect for updating the title</span><br>  useEffect(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateTitle</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">document</span>.title = name + <span class="hljs-string">&quot; &quot;</span> + surname;<br>  &#125;);<br><br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// ------------</span><br><span class="hljs-comment">// é¦–æ¬¡æ¸²æŸ“</span><br><span class="hljs-comment">// ------------</span><br>useState(<span class="hljs-string">&quot;Mary&quot;</span>); <span class="hljs-comment">// 1. ä½¿ç”¨ &#x27;Mary&#x27; åˆå§‹åŒ–å˜é‡åä¸º name çš„ state</span><br>useEffect(persistForm); <span class="hljs-comment">// 2. æ·»åŠ  effect ä»¥ä¿å­˜ form æ“ä½œ</span><br>useState(<span class="hljs-string">&quot;Poppins&quot;</span>); <span class="hljs-comment">// 3. ä½¿ç”¨ &#x27;Poppins&#x27; åˆå§‹åŒ–å˜é‡åä¸º surname çš„ state</span><br>useEffect(updateTitle); <span class="hljs-comment">// 4. æ·»åŠ  effect ä»¥æ›´æ–°æ ‡é¢˜</span><br><br><span class="hljs-comment">// -------------</span><br><span class="hljs-comment">// äºŒæ¬¡æ¸²æŸ“</span><br><span class="hljs-comment">// -------------</span><br>useState(<span class="hljs-string">&quot;Mary&quot;</span>); <span class="hljs-comment">// 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰</span><br>useEffect(persistForm); <span class="hljs-comment">// 2. æ›¿æ¢ä¿å­˜ form çš„ effect</span><br>useState(<span class="hljs-string">&quot;Poppins&quot;</span>); <span class="hljs-comment">// 3. è¯»å–å˜é‡åä¸º surname çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰</span><br>useEffect(updateTitle); <span class="hljs-comment">// 4. æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect</span><br><br><span class="hljs-comment">// ...</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ Hook éƒ½ä¼šæŒ‰ç…§æ­£ç¡®çš„è°ƒç”¨é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”åœ¨å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒä¸€è‡´</p>
<h2 id="ä¸ºä»€ä¹ˆè¦åœ¨ç»„ä»¶æœ€é¡¶å±‚ä½¿ç”¨-Hook"><a href="#ä¸ºä»€ä¹ˆè¦åœ¨ç»„ä»¶æœ€é¡¶å±‚ä½¿ç”¨-Hook" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åœ¨ç»„ä»¶æœ€é¡¶å±‚ä½¿ç”¨ Hook"></a>ä¸ºä»€ä¹ˆè¦åœ¨ç»„ä»¶æœ€é¡¶å±‚ä½¿ç”¨ Hook</h2><p>åŠ å…¥æˆ‘ä»¬æŠŠä¸Šé¢çš„ä¸€ä¸ª Hook æ”¾åˆ°ä¸€ä¸ªæ¡ä»¶è¯­å¥ä¸­ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (name !== <span class="hljs-string">&quot;&quot;</span>) &#123;<br>  useEffect(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">persistForm</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-built_in">localStorage</span>.setItem(<span class="hljs-string">&quot;formData&quot;</span>, name);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å½“æ¡ä»¶ä¸º false æ—¶ï¼Œè°ƒç”¨é¡ºåºä¼šå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useState(<span class="hljs-string">&quot;Mary&quot;</span>); <span class="hljs-comment">// 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰</span><br><span class="hljs-comment">// useEffect(persistForm)  // æ­¤ Hook è¢«å¿½ç•¥ï¼</span><br>useState(<span class="hljs-string">&quot;Poppins&quot;</span>); <span class="hljs-comment">// 2 ï¼ˆä¹‹å‰ä¸º 3ï¼‰ã€‚è¯»å–å˜é‡åä¸º surname çš„ state å¤±è´¥</span><br>useEffect(updateTitle); <span class="hljs-comment">// 3 ï¼ˆä¹‹å‰ä¸º 4ï¼‰ã€‚æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect å¤±è´¥</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æœéœ€è¦æ¡ä»¶åˆ¤æ–­å¯ä»¥åœ¨ hook å†…éƒ¨ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useEffect(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">persistForm</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-comment">// ğŸ‘ å°†æ¡ä»¶åˆ¤æ–­æ”¾ç½®åœ¨ effect ä¸­</span><br>  <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    <span class="hljs-built_in">localStorage</span>.setItem(<span class="hljs-string">&quot;formData&quot;</span>, name);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>

<h1 id="Hook-API"><a href="#Hook-API" class="headerlink" title="Hook API"></a>Hook API</h1><h2 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h2><h3 id="å‡½æ•°å¼æ›´æ–°"><a href="#å‡½æ•°å¼æ›´æ–°" class="headerlink" title="å‡½æ•°å¼æ›´æ–°"></a>å‡½æ•°å¼æ›´æ–°</h3><p>å¦‚æœå½“å‰ state çš„æ›´æ–°ä¾èµ–äºä¸Šä¸€ä¸ª stateï¼Œåˆ™å¯ä»¥ä½¿ç”¨å‡½æ•°å¼æ›´æ–°çš„æ–¹å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount - <span class="hljs-number">1</span>)&#125;&gt;-&lt;/button&gt;<br></code></pre></td></tr></table></figure>

<h3 id="æƒ°æ€§åˆå§‹-state"><a href="#æƒ°æ€§åˆå§‹-state" class="headerlink" title="æƒ°æ€§åˆå§‹ state"></a>æƒ°æ€§åˆå§‹ state</h3><p>å¦‚æœåˆå§‹å€¼éœ€è¦ç»è¿‡å¤§é‡å¤æ‚çš„è®¡ç®—è·å¾—ï¼Œå¯ä»¥ä½¿ç”¨æƒ°æ€§åˆå§‹ state</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> [state, setState] = useState(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> initialState = someExpensiveComputation(props);<br>  <span class="hljs-keyword">return</span> initialState;<br>&#125;);<br></code></pre></td></tr></table></figure>

<h3 id="è·³è¿‡-state-æ›´æ–°"><a href="#è·³è¿‡-state-æ›´æ–°" class="headerlink" title="è·³è¿‡ state æ›´æ–°"></a>è·³è¿‡ state æ›´æ–°</h3><p>å¦‚æœ setState æ—¶ä¼ å…¥ä¸Šä¸€ä¸ª stateï¼Œåˆ™ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œä¹Ÿä¸ä¼šè§¦å‘ effect,æ¯”è¾ƒé‡‡ç”¨çš„æ˜¯<code>object.is</code>ç®—æ³•ã€‚</p>
<h2 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h2><p>è¡¥å……è¯´æ˜ï¼šå¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯[],é‚£ä¹ˆè¿™ä¸ª effect åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<h2 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h2><p>è¯»å– context çš„å€¼ä»¥åŠè®¢é˜… context çš„å˜åŒ–ï¼Œç›¸å½“äº class ç»„ä»¶ä¸­çš„<code>static contextType = MyContext</code> æˆ–è€… <code>&lt;MyContext.Consumer&gt;</code>,ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> themes = &#123;<br>  light: &#123;<br>    foreground: <span class="hljs-string">&quot;#000000&quot;</span>,<br>    background: <span class="hljs-string">&quot;#eeeeee&quot;</span>,<br>  &#125;,<br>  dark: &#123;<br>    foreground: <span class="hljs-string">&quot;#ffffff&quot;</span>,<br>    background: <span class="hljs-string">&quot;#222222&quot;</span>,<br>  &#125;,<br>&#125;;<br><br><span class="hljs-keyword">const</span> ThemeContext = React.createContext(themes.light);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> (<br>    &lt;ThemeContext.Provider value=&#123;themes.dark&#125;&gt;<br>      &lt;Toolbar /&gt;<br>    &lt;/ThemeContext.Provider&gt;<br>  );<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Toolbar</span>(<span class="hljs-params">props</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> (<br>    &lt;div&gt;<br>      &lt;ThemedButton /&gt;<br>    &lt;/div&gt;<br>  );<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemedButton</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> theme = useContext(ThemeContext);<br>  <span class="hljs-keyword">return</span> (<br>    &lt;button style=&#123;&#123; <span class="hljs-attr">background</span>: theme.background, <span class="hljs-attr">color</span>: theme.foreground &#125;&#125;&gt;<br>      I am styled by theme context!<br>    &lt;/button&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialArg, init);<br></code></pre></td></tr></table></figure>

<p>åœ¨æŸäº›åµŒå¥—å¾ˆæ·±çš„æƒ…å†µä¸‹ï¼Œ<code>useReducer</code>æ¯”<code>useState</code>æ›´é€‚ç”¨ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡å‘å­ç»„ä»¶ä¼ é€’ dispatch è€Œä¸æ˜¯å›è°ƒå‡½æ•°ã€‚</p>
<p>è®¡æ•°å™¨ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> initialState = &#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reducer</span>(<span class="hljs-params">state, action</span>) </span>&#123;<br>  <span class="hljs-keyword">switch</span> (action.type) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;increment&quot;</span>:<br>      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.count + <span class="hljs-number">1</span> &#125;;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;decrement&quot;</span>:<br>      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.count - <span class="hljs-number">1</span> &#125;;<br>    <span class="hljs-keyword">default</span>:<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState);<br>  <span class="hljs-keyword">return</span> (<br>    &lt;&gt;<br>      Count: &#123;state.count&#125;<br>      &lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> dispatch(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;decrement&quot;</span> &#125;)&#125;&gt;-&lt;/button&gt;<br>      &lt;button onClick=&#123;<span class="hljs-function">() =&gt;</span> dispatch(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;increment&quot;</span> &#125;)&#125;&gt;+&lt;/button&gt;<br>    &lt;/&gt;<br>  );<br>&#125;<br></code></pre></td></tr></table></figure>

<p>useReducer çš„ç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šåˆå§‹ state,ç¬¬ä¸‰ä¸ªå‚æ•°ç”¨æ¥æƒ°æ€§åˆå§‹åŒ–ï¼Œä¾‹å¦‚ä¼ ä¸€ä¸ªå‡½æ•°ã€‚</p>
<h2 id="useCallback-amp-amp-useMemo"><a href="#useCallback-amp-amp-useMemo" class="headerlink" title="useCallback &amp;&amp; useMemo"></a>useCallback &amp;&amp; useMemo</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> memoizedCallback = useCallback(<span class="hljs-function">() =&gt;</span> &#123;<br>  doSomething(a, b);<br>&#125;, [a, b]);<br><br><span class="hljs-keyword">const</span> memoizedValue = useMemo(<span class="hljs-function">() =&gt;</span> computeExpensiveValue(a, b), [a, b]);<br></code></pre></td></tr></table></figure>

<p>ä¸¤è€…éƒ½æ˜¯æ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µ,å½“ç¬¬äºŒä¸ªå‚æ•°é‡Œé¢çš„å€¼æ²¡æœ‰å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå…¥å‚ä¸€ä¸­çš„å‡½æ•°ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>åŒºåˆ«ï¼š</p>
<ol>
<li>useCallback ç¼“å­˜çš„æ˜¯å…¥å‚ä¸€ä¸­çš„å‡½æ•°ã€‚</li>
<li>useMemo ç¼“å­˜çš„æ˜¯è®¡ç®—å¾—åˆ°çš„å€¼ã€‚</li>
</ol>
<h2 id="useRef-amp-amp-useImperativeHandle"><a href="#useRef-amp-amp-useImperativeHandle" class="headerlink" title="useRef &amp;&amp; useImperativeHandle"></a>useRef &amp;&amp; useImperativeHandle</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> refContainer = useRef(initialValue);<br></code></pre></td></tr></table></figure>

<p><code>useRef</code> è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ <code>.current</code> å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°ï¼ˆ<code>initialValue</code>ï¼‰ã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useImperativeHandle(ref, createHandle, [deps]);<br></code></pre></td></tr></table></figure>

<p><code>useImperativeHandle</code> å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ ref æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼</p>
<h2 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h2><p>å…¶å‡½æ•°ç­¾åä¸ <code>useEffect</code> ç›¸åŒï¼Œä½†å®ƒä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ effectã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“ã€‚åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼Œ<code>useLayoutEffect</code> å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒæ­¥åˆ·æ–°ã€‚</p>
<p>å°½å¯èƒ½ä½¿ç”¨æ ‡å‡†çš„ useEffect ä»¥é¿å…é˜»å¡è§†è§‰æ›´æ–°</p>
<h2 id="useDebugValue"><a href="#useDebugValue" class="headerlink" title="useDebugValue"></a>useDebugValue</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">useDebugValue(value)<br></code></pre></td></tr></table></figure>

<p>useDebugValue å¯ç”¨äºåœ¨ React å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ hook çš„æ ‡ç­¾</p>

    </section>
    <section class="extra">
      
        <ul class="copyright">
  
  <li><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« å‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"
      rel="external nofollow" target="_blank"> BY-NC-SA </a>è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
  
</ul>
      
      
        <section class="donate">
  <div class="qrcode">
    <img   class="lazyload" data-original="/images/theme/zhifubao.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" >
  </div>
  <div class="icon">
    <a href="javascript:;" id="alipay"><i class="iconfont iconalipay"></i></a>
    <a href="javascript:;" id="wechat"><i class="iconfont iconwechat-fill"></i></a>
  </div>
</section>
      
      
      
<nav class="nav">
  
    <a href="/2021/03/22/Mobx/"><i class="iconfont iconleft"></i></a>
  
  
    <a href="/2021/03/14/react%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/">Reactæ ¸å¿ƒæ¦‚å¿µ<i class="iconfont iconright"></i></a>
  
</nav>

    </section>
    
      <section class="comments">
        
          <div class="btn" id="comments-btn">æŸ¥çœ‹è¯„è®º</div>
        
        
      </section>
    
  </section>
</article>
  </div>
</main>
  <footer class="footer">
  <div class="footer-social">
    
    
    
    
    
    <a href="tencent://message/?Menu=yes&uin=969122484 " target="_blank" onMouseOver="this.style.color= '#12B7F5'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconQQ "></i>
    </a>
    
    
    
    
    
    <a href="javascript:; " target="_blank" onMouseOver="this.style.color= '#09BB07'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconwechat-fill "></i>
    </a>
    
    
    
    
    
    <a href="https://github.com/ImDaret " target="_blank" onMouseOver="this.style.color= '#24292E'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  icongithub-fill "></i>
    </a>
    
    
    
    
    
    <a href="ling_jintao@163.com " target="_blank" onMouseOver="this.style.color='#FFBE5B'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconmail"></i>
    </a>
    
  </div>
  <div class="footer-copyright"><p>CopyrightÂ© 2019-2020 | <a target="_blank" href="https://www.001f3.cn">å¹³å¸¸å¿ƒ</a> .AllRightsReserved</p></div>
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  <div class="fab fab-daovoice">
    <i class="iconfont iconcomment"></i>
  </div>
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
</body>


<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>






<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>






<script src="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>






<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>






<script src="/js/utils.js"></script>
<script src="/js/modules.js"></script>
<script src="/js/zui.js"></script>
<script src="/js/script.js"></script>





<script>
  (function (i, s, o, g, r, a, m) {
    i["DaoVoiceObject"] = r;
    i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o), m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    a.charset = "utf-8";
    m.parentNode.insertBefore(a, m)
  })(window, document, "script", ('https:' == document.location.protocol ? 'https:' : 'http:') +
    "//widget.daovoice.io/widget/0f81ff2f.js", "daovoice")
  daovoice('init', {
    app_id: "abcdefg"
  }, {
    launcher: {
      disableLauncherIcon: true,
    },
  });
  daovoice('update');
</script>



<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>


<script>
  var _hmt = _hmt || [];
  (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?4c204d8bc027a0455b5fc642ac334ca8";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>










</html>